# ğŸ† Sistema de Tabela de ClassificaÃ§Ã£o em Tempo Real

Um sistema completo de leaderboard em tempo real desenvolvido com Java, Spring Boot, PostgreSQL e Redis.

## ğŸ“‹ Funcionalidades

### âœ… Implementado
- **AutenticaÃ§Ã£o JWT** - Registro e login de usuÃ¡rios
- **SubmissÃ£o de PontuaÃ§Ãµes** - UsuÃ¡rios podem enviar scores para diferentes jogos
- **Leaderboards em Tempo Real** - Rankings globais e por jogo usando Redis Sorted Sets
- **Consultas de Ranking** - PosiÃ§Ã£o do usuÃ¡rio, top N, jogadores prÃ³ximos
- **RelatÃ³rios de Performance** - Top performers em perÃ­odos especÃ­ficos
- **Fallback para Banco** - Sistema funciona mesmo se Redis estiver indisponÃ­vel
- **SincronizaÃ§Ã£o AutomÃ¡tica** - Leaderboards sÃ£o sincronizados periodicamente
- **API RESTful** - Endpoints completos e bem documentados
- **Tratamento de ExceÃ§Ãµes** - Error handling robusto
- **Testes UnitÃ¡rios** - Cobertura de testes abrangente

## ğŸš€ Tecnologias Utilizadas

- **Backend**: Java 17, Spring Boot 3.x
- **Banco de Dados**: PostgreSQL
- **Cache/Leaderboard**: Redis
- **AutenticaÃ§Ã£o**: JWT (JSON Web Tokens)
- **DocumentaÃ§Ã£o**: OpenAPI/Swagger
- **Testes**: JUnit 5, Mockito, TestContainers

## ğŸ—ï¸ Arquitetura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚   Spring Boot   â”‚    â”‚   PostgreSQL    â”‚
â”‚   (Client)      â”‚â—„â”€â”€â–ºâ”‚   Application   â”‚â—„â”€â”€â–ºâ”‚   Database      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚     Redis       â”‚
                       â”‚  (Leaderboards) â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

### PrÃ©-requisitos
- Java 17 ou superior
- Maven 3.8+
- PostgreSQL 13+
- Redis 6+
- Docker (opcional)

### 1. Clone o repositÃ³rio
```bash
git clone https://github.com/seu-usuario/leaderboard-system.git
cd leaderboard-system
```

### 2. Configure o banco PostgreSQL
```sql
CREATE DATABASE leaderboard;
CREATE USER leaderboard_user WITH PASSWORD 'password';
GRANT ALL PRIVILEGES ON DATABASE leaderboard TO leaderboard_user;
```

### 3. Configure Redis
```bash
# Ubuntu/Debian
sudo apt install redis-server
sudo systemctl start redis-server

# macOS
brew install redis
brew services start redis

# Docker
docker run -d -p 6379:6379 --name redis redis:latest
```

### 4. Configure variÃ¡veis de ambiente
```bash
export DB_USERNAME=leaderboard_user
export DB_PASSWORD=password
export JWT_SECRET=mySecretKey123456789012345678901234567890
export REDIS_HOST=localhost
export REDIS_PORT=6379
```

### 5. Execute a aplicaÃ§Ã£o
```bash
# Compile e execute
mvn clean install
mvn spring-boot:run

# Ou usando Docker Compose
docker-compose up -d
```

A aplicaÃ§Ã£o estarÃ¡ disponÃ­vel em: `http://localhost:8080`

## ğŸ“š API Endpoints

### AutenticaÃ§Ã£o
```http
POST/api/auth/register
POST /api/auth/login
```

### Jogos
```http
GET  /api/games/public           # Listar todos os jogos
GET  /api/games/public/{id}      # Detalhes de um jogo
```

### PontuaÃ§Ãµes
```http
POST /api/scores/submit          # Submeter pontuaÃ§Ã£o
GET  /api/scores/my              # Minhas pontuaÃ§Ãµes
GET  /api/scores/my/game/{id}    # Minhas pontuaÃ§Ãµes em um jogo
GET  /api/scores/top/global      # Top pontuaÃ§Ãµes globais
GET  /api/scores/top/game/{id}   # Top pontuaÃ§Ãµes de um jogo
```

### Leaderboards
```http
GET  /api/leaderboard/public/global              # Ranking global
GET  /api/leaderboard/public/game/{id}           # Ranking de um jogo
GET  /api/leaderboard/my/ranking                 # Meu ranking
GET  /api/leaderboard/my/neighbors               # Jogadores prÃ³ximos
GET  /api/leaderboard/range/global?start=1&end=10 # Faixa especÃ­fica
```

### Exemplo de Uso

#### 1. Registrar usuÃ¡rio
```bash
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "jogador1",
    "email": "jogador1@example.com",
    "password": "minhasenha"
  }'
```

#### 2. Fazer login
```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "jogador1",
    "password": "minhasenha"
  }'
```

#### 3. Submeter pontuaÃ§Ã£o
```bash
curl -X POST http://localhost:8080/api/scores/submit \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer SEU_JWT_TOKEN" \
  -d '{
    "gameId": 1,
    "score": 1500
  }'
```

#### 4. Ver leaderboard global
```bash
curl http://localhost:8080/api/leaderboard/public/global?limit=10
```

## ğŸ”§ ConfiguraÃ§Ã£o AvanÃ§ada

### application.yml personalizado
```yaml
spring:
  profiles:
    active: dev
    
  datasource:
    url: jdbc:postgresql://localhost:5432/leaderboard
    username: ${DB_USERNAME:leaderboard_user}
    password: ${DB_PASSWORD:password}
  
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 10
        max-idle: 10

jwt:
  secret: ${JWT_SECRET:mySecretKey}
  expiration: 86400000 # 24 horas

logging:
  level:
    com.leaderboard: DEBUG
    org.springframework.security: INFO
```

### Docker Compose
```yaml
version: '3.8'
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: leaderboard
      POSTGRES_USER: leaderboard_user
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  app:
    build: .
    ports:
      - "8080:8080"
    environment:
      - DB_USERNAME=leaderboard_user
      - DB_PASSWORD=password
      - REDIS_HOST=redis
    depends_on:
      - postgres
      - redis

volumes:
  postgres_data:
```

## ğŸ§ª Executando Testes

```bash
# Todos os testes
mvn test

# Testes especÃ­ficos
mvn test -Dtest=LeaderboardServiceTest

# Testes de integraÃ§Ã£o
mvn test -Dtest=LeaderboardIntegrationTest

# Com coverage
mvn jacoco:prepare-agent test jacoco:report
```

## ğŸ“ˆ Monitoramento

### Health Check
```bash
curl http://localhost:8080/api/leaderboard/admin/status
```

### SincronizaÃ§Ã£o Manual
```bash
curl -X POST http://localhost:8080/api/leaderboard/admin/sync \
  -H "Authorization: Bearer ADMIN_TOKEN"
```

## ğŸ” Troubleshooting

### Redis nÃ£o estÃ¡ funcionando
- Verifique se o Redis estÃ¡ rodando: `redis-cli ping`
- Sistema funciona em modo fallback usando apenas PostgreSQL
- Use endpoint de sincronizaÃ§Ã£o para restaurar dados no Redis

### Performance
- Configure connection pools adequadamente
- Monitore uso de memÃ³ria do Redis
- Considere particionamento para high-scale

### Logs
- Logs em `logs/application.log`
- Level DEBUG para desenvolvimento
- Level INFO/WARN para produÃ§Ã£o

## ğŸš€ Deploy em ProduÃ§Ã£o

### VariÃ¡veis de Ambiente ObrigatÃ³rias
```bash
export SPRING_PROFILES_ACTIVE=prod
export DB_USERNAME=prod_user
export DB_PASSWORD=secure_password
export JWT_SECRET=very_secure_secret_key_here
export REDIS_HOST=redis.production.com
export REDIS_PASSWORD=redis_secure_password
```

### OtimizaÃ§Ãµes Recomendadas
- Use pool de conexÃµes otimizado
- Configure Redis clustering para alta disponibilidade
- Implemente rate limiting
- Configure HTTPS
- Use CDN para assets estÃ¡ticos
- Configure backup automÃ¡tico do PostgreSQL

## ğŸ¤ ContribuiÃ§Ã£o

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/nova-feature`)
3. Commit suas mudanÃ§as (`git commit -am 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/nova-feature`)
5. Crie um Pull Request

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ licenciado sob a MIT License - veja o arquivo [LICENSE](LICENSE) para detalhes.

## ğŸ‘¨â€ğŸ’» Autor

Desenvolvido por [Seu Nome]

## ğŸ¯ PrÃ³ximos Passos

- [ ] Interface web (React/Vue.js)
- [ ] WebSocket para atualizaÃ§Ãµes em tempo real
- [ ] Sistema de achievements/conquistas
- [ ] Analytics e mÃ©tricas avanÃ§adas
- [ ] API rate limiting
- [ ] NotificaÃ§Ãµes push
- [ ] Sistema de temporadas/competiÃ§Ãµes

---

**âœ¨ Sistema funcionando! Agora vocÃª tem um leaderboard completo e profissional!**